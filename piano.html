<!DOCTYPE html>
<html lang="en">

<head>
  <title>SPACE Three.JS</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <link rel="stylesheet" href="css/basic.css">

  <script src="three.js"></script>
  <script src="js/Detector.js"></script>
  <script src="js/OrbitControls.js"></script>
  <script type="text/javascript">


    // Checks that your browser supports WebGL. 
    if (!Detector.webgl) Detector.addGetWebGLMessage();

    var renderer = null;
    var scene = null;
    var camera = null;
    var piano = null;
    var piano_group = null;
    var earth = null;
    var moon = null;
    var solar_sys = null;
    var moon_group = null;
    var mars = null;
    var cameraAngle = null;
    var curTime = Date.now();

    // This function is called whenever the document is loaded
    function init() {

      // Get display canvas
      var canvas = document.getElementById("webglcanvas");
      console.log(canvas);

      // Create the Three.js renderer and attach it to our canvas
      renderer = new THREE.WebGLRenderer({
        canvas: canvas,
        antialias: true
      });
      // Set the viewport size
      renderer.setSize(canvas.width, canvas.height);
      // Create a new Three.js scene
      scene = new THREE.Scene();
      // scene.background = new THREE.TextureLoader().load( 'images/MilkyWay/posy.jpg' );
      // Add  a camera so we can view the scene
      camera = new THREE.PerspectiveCamera(45, canvas.width / canvas.height,
        1, 4000);

      camera.position.z = 20;


    //  Create the sun map & geometry
    var sun_material = new THREE.MeshBasicMaterial({ map: map });
    var geometry = new THREE.CubeGeometry(.9, 32, 32);
    piano = new THREE.Mesh(geometry, sun_material);
    piano.position.set(0, 0, 0);


      /// SUN -------------------------------------------


      // Add a white point light


      /// MARS -------------------------------------------


      /// EARTH -------------------------------------------


      /// MOON  -------------------------------------------



      /// GROUPS ---------------------------------------------

      piano_group = new THREE.Group();
      


      /// CAMERA CONTROLS ------------------------------------------

      controls = new THREE.OrbitControls(camera, renderer.domElement, mars.matrixWorld.getPosition());

      //controls.addEventListener( 'change', render ); // call this only in static scenes (i.e., if there is no animation loop)
      controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled
      controls.dampingFactor = 0.25;
      controls.screenSpacePanning = false;
      controls.minDistance = 1;
      controls.maxDistance = 20;

      // Finally, add the mesh to our scene
      scene.add(piano_group);
    }

    // This function is called regularly to update the canvas webgl.
    function run() {
      // Ask to call again run 
      requestAnimationFrame(run);

      // Render the scene
      render();

      // Calls the animate function if objects or camera should move
      animate();
    }

    // This function is called regularly to take care of the rendering.
    function render() {
      // Render the scene
      renderer.render(scene, camera);
    }

    // This function is called regularly to update objects.
    function animate() {

      // Computes how time has changed since last display
      var now = Date.now();
      var deltaTime = now - curTime;
      curTime = now;
      var fracTime = deltaTime / 1000; // in seconds
      // Now we can move objects, camera, etc.
      // Example: rotation cube
      var angle = 0.1 * Math.PI * 2 * fracTime; // one turn per 10 second.

      var angleR = fracTime * Math.PI * 2;

      
      cameraAngle += angleR / 100;

      //camera.position.x = 5 * Math.cos( cameraAngle );
      //camera.position.z = 3 * Math.sin( cameraAngle );

      controls.update();
    }


  </script>
</head>

<body>
  <div id="info"> ThreeJS app will become space invader ? </div>
  <canvas id="webglcanvas" style="border: none;background-color:#000000" width="1920" height="1080"></canvas>
  <!-- We run the WebGL code at the end to be sure that the document is loaded.
      -->
  <script>
    // We put the starting point of the javascript here, so that the whole page
    // is loaded before WebGL code is executed.
    init(); run();
  </script>
</body>

</html>